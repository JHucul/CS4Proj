<!DOCTYPE html>
<html lang="en">
<head>
    <title>Picture Display and Upload</title>
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>

</head>
<body>
  <a href="/">Text Log</a>
  |
  <a href="/uploadimage">Upload Image</a>

  <br>
  <h1><u>Text Log</u></h1>
  <input type="button" id="dispButtn" value="Display">
  <label for="nameInput">Your Name:</label>
  <input type="text" id="nameInput" value="Name">
  <br>
  <br>
  <textarea id="textDisplay" rows="20" cols="75" readonly></textarea>
  <br>
  <br>
  <label for="input">Your Message:</label>
  <input type="text" id="input">
  <input type="button" id="sendBut" value="Send">
  <input type="button" id="clearBut" value="Clear Log">

<script>
  	setInterval(ShowTextLogBut, 500);

    function ShowTextLog(data){
    	$("#textDisplay").val(data.textLog)
    	if(document.getElementById("textDisplay").scrollTop >= document.getElementById("textDisplay").scrollHeight - document.getElementById("textDisplay").scrollHeight*.5)
			document.getElementById("textDisplay").scrollTop = document.getElementById("textDisplay").scrollHeight
    }
    function ShowTextLogBut(data){
      	$.get("/getTextLogText", null, ShowTextLog);
    }
    function InputText(){
    	$.post('/setTextLogText', {text:"\n" + $("#nameInput").val() + "\n" + $("#input").val()+ "\n"}, null)
      	$.get("/getTextLogText", null, ShowTextLog);
    }
    function ClearTextLog(data){
      	$.post("/clearTextLogText", null, null);
      	ShowTextLogBut();
    }


	window.onload = function NewFunction() {
		document.getElementById("textDisplay").scrollTop = document.getElementById("textDisplay").scrollHeight
    }
    $(document).ready(function(){ 
      $.get("/getTextLogText", null, ShowTextLog);
      $("#dispButtn").click(ShowTextLogBut);
      $("#sendBut").click(InputText);
      $("#clearBut").click(ClearTextLog);
      $('#input').keydown(function(e){
	    if(e.keyCode === 13){
	    	InputText();
	     }  
	   });
    });     


</script>
</body>
</html>